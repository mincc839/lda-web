let nombreServ='C2CLandingLDA';const codIdioma='ES';const tipoC2C=3;let cod2TipoPoliza='00';function callLlamameAPI(elem,from,idServicio,indVehiculo,telefono,nameEvento,url,telefonoLdirecta){let dataLeads={"telefono":telefono};getIdLead(dataLeads).then(idLeadVal=>{if(idLeadVal!=null){var elemDivLeadAux=document.createElement('div');elemDivLeadAux.classList.add("d-none");elemDivLeadAux.setAttribute("id","elemDivLead");elemDivLeadAux.setAttribute("data-lead",idLeadVal);document.body.appendChild(elemDivLeadAux);}
let idLeadDiv=document.getElementById("elemDivLead");let idLeadValue="";if(idLeadDiv!=null){idLeadValue=idLeadDiv.getAttribute("data-lead");}
let containerParent=$(elem).closest(".lda-hero-media-right__content");$(elem).attr("data-ref-id",elem.id);if(indVehiculo==='S'){cod2TipoPoliza='09';nombreServ='C2CLandingSalud'}
if(containerParent.find("#teLlamamosBtn").hasClass("lda-disabled")){containerParent.find("#lda-error-tlfn").css({"display":"block"});}else{var values={nombre:nombreServ,idServicio:idServicio,indVehiculo:indVehiculo,cod2TipoPoliza:cod2TipoPoliza,tipoC2C:tipoC2C,from:from,codIdioma:codIdioma,telefono:telefono,idLead:idLeadValue};console.log("-----");console.log(values);console.log(" URL de llamada: "+url);let teLlamamosMal='\xa1Algo\x20ha\x20salido\x20mal\x21';let teLLamamosBodyKo='\x3cspan\x3eTus\x20datos\x20no\x20se\x20han\x20podido\x20enviar\x2e\x20Por\x20favor\x20comprueba\x20que\x20están\x20correctos\x20y\x20vuelve\x20a\x20intentarlo\x2e\x3cbr\x2f\x3e\x3cbr\x2f\x3eTambién\x20puedes\x20contactar\x20en\x20el\x20\x3ca\x20class\x3d\x22lda-tel__primary\x20ml-sm-1\x20pl-4\x20lda-link\x22\x20href\x3d\x22tel\x3a';let teLlamamosProbar='Probar\x20de\x20nuevo';if(window.location.pathname.startsWith(window.urlEnglish)){teLlamamosMal='Something\x20has\x20gone\x20wrong\x21';teLLamamosBodyKo='\x3cspan\x3eYour\x20details\x20could\x20not\x20be\x20sent\x2e\x20Please\x20try\x20again\x2e\x3cbr\x2f\x3e\x3cbr\x2f\x3eYou\x20can\x20also\x20call\x20us\x20on\x20\x3ca\x20class\x3d\x22lda-tel__primary\x20ml-sm-1\x20pl-4\x20lda-link\x22\x20href\x3d\x22tel\x3a';teLlamamosProbar='Try\x20again';}else if(window.location.pathname.startsWith(window.urlGerman)){teLlamamosMal='Es\x20ist\x20ein\x20Fehler\x20aufgetreten\x2e';teLLamamosBodyKo='\x3cspan\x3eIhre\x20Daten\x20konnten\x20nicht\x20gesendet\x20werden\x2e\x20Bitte\x20versuchen\x20Sie\x20es\x20noch\x20einmal\x2e\x3cbr\x2f\x3e\x3cbr\x2f\x3eSie\x20können\x20uns\x20auch\x20unter\x20der\x20Nummer\x20\x3ca\x20class\x3d\x22lda-tel__primary\x20ml-sm-1\x20pl-4\x20lda-link\x22\x20href\x3d\x22tel\x3a';teLlamamosProbar='Bitte\x20versuchen\x20Sie\x20es\x20erneut';}else if(window.location.pathname.startsWith(window.urlCatalan)){teLlamamosMal='Alguna\x20cosa\x20ha\x20sortit\x20malament\x21';teLLamamosBodyKo='\x3cspan\x3eNo\x20s\x27han\x20pogut\x20enviar\x20les\x20teves\x20dades\x2e\x20Si\x20us\x20plau\x2c\x20torna-ho\x20a\x20intentar\x2e\x3cbr\x2f\x3e\x3cbr\x2f\x3eTambé\x20pots\x20contactar\x20al\x20\x3ca\x20class\x3d\x22lda-tel__primary\x20ml-sm-1\x20pl-4\x20lda-link\x22\x20href\x3d\x22tel\x3a';teLlamamosProbar='Prova\x20de\x20nou';}
$.ajax({url:url,type:"POST",data:values,dataType:"json",crossDomain:true,success:function(data){console.log(" La llamada ha ido bien. data.respuesta: "+data.respuesta);let teLlamamosGracias='\xa1Gracias\x21';let teLLamamosBodyOk='\x3cspan\x3eGracias\x20por\x20tu\x20confianza\x20en\x20Línea\x20Directa\x2c\x20un\x20técnico\x20comercial\x20se\x20pondrá\x20en\x20contacto\x20contigo\x3cbr\x2f\x3e\x3cbr\x2f\x3eTambién\x20puedes\x20contactar\x20en\x20el\x20\x3ca\x20class\x3d\x22lda-tel__primary\x20ml-sm-1\x20pl-4\x20lda-link\x22\x20href\x3d\x22tel\x3a';let teLlamamosVolver='Volver\x20a\x20Linea\x20Directa';if(window.location.pathname.startsWith(window.urlEnglish)){teLlamamosGracias='Thank\x20you\x21';teLLamamosBodyOk='\x3cspan\x3eThank\x20you\x20for\x20choosing\x20Línea\x20Directa\x2c\x20a\x20sales\x20technician\x20will\x20contact\x20you\x20shortly\x2e\x3cbr\x2f\x3e\x3cbr\x2f\x3eYou\x20can\x20also\x20call\x20us\x20on\x20\x3ca\x20class\x3d\x22lda-tel__primary\x20ml-sm-1\x20pl-4\x20lda-link\x22\x20href\x3d\x22tel\x3a';teLlamamosVolver='Go\x20back\x20to\x20Línea\x20Directa';}else if(window.location.pathname.startsWith(window.urlGerman)){teLlamamosGracias='Vielen\x20Dank\x21';teLLamamosBodyOk='\x3cspan\x3eVielen\x20Dank\x20für\x20Ihr\x20Vertrauen\x20in\x20Línea\x20Directa\x2e\x20Ein\x20technischer\x20Berater\x20wird\x20sich\x20mit\x20Ihnen\x20in\x20Verbindung\x20setzen\x2e\x3cbr\x2f\x3e\x3cbr\x2f\x3eSie\x20können\x20uns\x20auch\x20unter\x20der\x20Nummer\x20\x3ca\x20class\x3d\x22lda-tel__primary\x20ml-sm-1\x20pl-4\x20lda-link\x22\x20href\x3d\x22tel\x3a';teLlamamosVolver='Zurück\x20zu\x20Línea\x20Directa';}else if(window.location.pathname.startsWith(window.urlCatalan)){teLlamamosGracias='Gràcies';teLLamamosBodyOk='\x3cspan\x3eGràcies\x20per\x20la\x20teva\x20confiança\x20en\x20Línea\x20Directa\x2e\x20Un\x20tècnic\x20comercial\x20es\x20posarà\x20en\x20contacte\x20amb\x20tu\x2e\x3cbr\x2f\x3e\x3cbr\x2f\x3eTambé\x20pots\x20contactar\x20al\x20\x3ca\x20class\x3d\x22lda-tel__primary\x20ml-sm-1\x20pl-4\x20lda-link\x22\x20href\x3d\x22tel\x3a';teLlamamosVolver='Torna\x20a\x20Línea\x20Directa';}
if((data.respuesta&&data.respuesta.indexOf("CMB_OK")>-1)||(data.respuesta&&data.respuesta.indexOf("C2C_OK")>-1)||(data.respuesta&&data.respuesta.indexOf("OK")>-1)){set_modal(teLlamamosGracias,teLLamamosBodyOk+telefonoLdirecta+'" title="'+telefonoLdirecta+'">'+telefonoLdirecta+"</a></span>",teLlamamosVolver,'');if(nameEvento==="salud"&&window.location.href.includes("/dental.html")){if(window.isLanding){sendEventAnalitica('Landing','Click',nameEvento,'c2c_dental');}else{sendEventAnalitica('Telefono','C2C',nameEvento,'c2c_dental');}}else if(nameEvento==="salud"&&window.location.href.includes("/completo.html")){if(window.isLanding){sendEventAnalitica('Landing','Click',nameEvento,'c2c_completo');}else{sendEventAnalitica('Telefono','C2C',nameEvento,'c2c_completo');}}else if(nameEvento==="salud"&&window.location.href.includes("/especialistas.html")){if(window.isLanding){sendEventAnalitica('Landing','Click',nameEvento,'c2c_especialistas');}else{sendEventAnalitica('Telefono','C2C',nameEvento,'c2c_especialistas');}}else{if(nameEvento===""){if(window.isLanding){sendEventAnalitica('Landing','Click',nameEvento,'c2c');}else{sendEventAnalitica('Home','C2C',nameEvento,'c2c');}}else{if(window.isLanding){sendEventAnalitica('Landing','Click',nameEvento,'c2c');}else{sendEventAnalitica('Telefono','C2C',nameEvento,'c2c');}}}
sendEventAnalitica('HTTP',analiticaGetPageName(),idServicio,'');}else if((data.respuesta&&data.respuesta.indexOf("CMB_KO")>-1)||(data.respuesta&&data.respuesta.indexOf("C2C_KO")>-1)||(data.respuesta&&data.respuesta.indexOf("KO")>-1)){set_modal(teLlamamosMal,teLLamamosBodyKo+telefonoLdirecta+'" title="'+telefonoLdirecta+'">'+telefonoLdirecta+"</a></span>",teLlamamosProbar,"hide_modal('[data-ref-id=\""+elem.id+"\"]')");}},error:function(jqXHR,textStatus,errorThrown){console.log(" No se ha podido conectar");console.debug('[LDA Te llamamos Script] - No se ha podido conectar');set_modal(teLlamamosMal,teLLamamosBodyKo+telefonoLdirecta+'" title="'+telefonoLdirecta+'">'+telefonoLdirecta+"</a></span>",teLlamamosProbar,"hide_modal('[data-ref-id=\""+elem.id+"\"]')");}}).fail(function(){set_onclick_modal(elem)});console.log("----");}
if(idLeadDiv!=null){idLeadDiv.remove();}});}
AUI().ready(function(){$("[name='nameInput']").each(function(){let inputTeLlamamos=$(this);let containerTeLlamamos=inputTeLlamamos.closest(".lda-hero-media-right__content");let tooltipTeLlamamos=containerTeLlamamos.find(".lda-tooltip__info");let tooltipLinkTeLlamamos=tooltipTeLlamamos.find("a");let buttonTeLlamamos=containerTeLlamamos.find("#teLlamamosBtn");if(($(window).width()<600)||inputTeLlamamos.length===0){buttonTeLlamamos.removeClass("lda-disabled");}
let isTooltipClicked=false;let tooltipTimeout;inputTeLlamamos.on("blur",function(){tooltipTimeout=setTimeout(function(){if(!isTooltipClicked&&document.activeElement!==tooltipLinkTeLlamamos[0]){tooltipTeLlamamos.hide();}},200);});inputTeLlamamos.on("keyup",function(){inputTeLlamamos.val(inputTeLlamamos.val().replace(/[^0-9]/gi,''));validarTeLlamamos(inputTeLlamamos);});tooltipLinkTeLlamamos.on("blur",function(){let link=this;setTimeout(function(){if(document.activeElement!==link&&document.activeElement!==inputTeLlamamos[0]){tooltipTeLlamamos.hide();}},200);});tooltipLinkTeLlamamos.on("click",function(){tooltipTeLlamamos.hide();});inputTeLlamamos.on("focus",function(){clearTimeout(tooltipTimeout);tooltipTeLlamamos.show();});tooltipTeLlamamos.on("mousedown",function(){isTooltipClicked=true;});$(document).on("mousedown",function(){isTooltipClicked=false;});});});function validarTeLlamamos(elem){let containerParent=$(elem).closest(".lda-hero-media-right__content");containerParent.find(".lda-tooltip__info").hide();var telefono=containerParent.find("#nameInput").val().replace(/[^0-9]/gi,'');let teLlamamosErrorLabel='Teléfono\x20no\x20válido\x2e\x20Debe\x20tener\x209\x20dígitos\x2e';if(window.location.pathname.startsWith(window.urlEnglish)){teLlamamosErrorLabel='Invalid\x20phone\x20number\x2e\x20It\x20must\x20have\x209\x20digits\x2e';}else if(window.location.pathname.startsWith(window.urlGerman)){teLlamamosErrorLabel='Ungültige\x20Telefonnummer';}else if(window.location.pathname.startsWith(window.urlCatalan)){teLlamamosErrorLabel='Telèfon\x20no\x20vàlid\x2e\x20Heu\x20de\x20tenir\x209\x20dígits\x2e';}
if(telefono==undefined||telefono.length!=9||!validaTelefono(telefono)){$(elem).addClass("lda-disabled");containerParent.find("#lda-error-tlfn").text(teLlamamosErrorLabel);containerParent.find("#lda-error-tlfn").css({"display":"block"});}else{$(elem).removeClass("lda-disabled");containerParent.find("#lda-error-tlfn").css({"display":"none"});containerParent.find("#lda-error-tlfn").text("");}}
function validaTelefono(numTelefono){var uno=numTelefono.toString().substring(0,1);if(numTelefono==''||isNaN(numTelefono)||numTelefono.length!=9||numTelefono=='666666666'||(uno!='6'&&uno!='7'&&uno!='9'&&uno!='8')){return false;}
return true;}
function getClosestNameInput(button){let input=$(button).closest(".lda-hero-media-right__content").find("[name='nameInput']");return input.length?input.val():'';}
async function getIdLead(leadData){try{let response=await DFI_client.generateLead(leadData);return response?.leadId??null;}catch(error){return null;}}